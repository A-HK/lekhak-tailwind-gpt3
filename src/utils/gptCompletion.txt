import { useEffect, useState, useRef } from "react";



function choosePrompt({selectedComponent, messages, setMessages, componentInput}){
  
  switch(selectedComponent) {
    case "HorizontalCardComponent":
      console.log("enters");
      setMessages([
        {"role": "system", "content": `You are a helpful assistant who generates only JSON object completions and nothing more. The user will provide a prompt. Generate only one JSON completion per prompt. The JSON format must be adhered to strictly, but the content should be creative. Do not reply with 'sure..', 'here's..' or anything of the sort. JUST the completion.`},
        {"role": "user", "content": "Grid of horizontal cards for vacation rentals, green"},
        {"role": "system", "content": `{"theme": "vacation rental", "colorScheme": "green", "component": {"type": "HorizontalCardComponent", "image": true, "content":[{"title":"Beach House", "body":"Beach houses are perfect for a relaxing getaway. They offer stunning views of the ocean and provide easy access to the beach.", "callsToAction" : ["Book Now", "Learn More"]}, {"title":"Mountain Cabin", "body":"Mountain cabins are great for those who love outdoor activities like hiking, skiing, and snowboarding. They offer beautiful views of the mountains and are often situated near ski resorts.", "callsToAction" : ["Book Now", "Learn More"]}, {"title":"City Apartment", "body":"City apartments are perfect for those who want to be in the heart of the action. They offer easy access to restaurants, bars, and shopping, and are often located in vibrant neighborhoods.", "callsToAction" : ["Book Now", "Learn More"]}]}}`},
        {"role": "user", "content": componentInput}
      ])
      break;
    case "VerticalCardComponent":
      setMessages([
        {"role": "system", "content": `You are a helpful assistant who generates only JSON object completions and nothing more. The user will provide a prompt. Generate only one JSON completion per prompt. The JSON format must be adhered to strictly, but the content should be creative. Do not reply with 'sure..', 'here's..' or anything of the sort. JUST the completion.`},
        {"role": "user", "content": "Create a pink grid of vertical cards for movie recommendations"},
        {"role": "system", "content": `{"theme": "movie recommendation", "colorScheme": "pink", "component": {"type": "VerticalCardComponent", "image": true, "content":[{"title":"Inception", "body":"Inception is a 2010 science fiction action film written and directed by Christopher Nolan, starring Leonardo DiCaprio, Ellen Page, and Joseph Gordon-Levitt. The film follows a skilled thief who is given the task of planting an idea in a target's subconscious.", "callsToAction" : ["Watch Now", "Learn More"]}, {"title":"The Shawshank Redemption", "body":"The Shawshank Redemption is a 1994 drama film written and directed by Frank Darabont, starring Tim Robbins and Morgan Freeman. The film tells the story of a banker who is sentenced to life in prison for a crime he did not commit.", "callsToAction" : ["Watch Now", "Learn More"]}, {"title":"The Godfather", "body":"The Godfather is a 1972 crime film directed by Francis Ford Coppola, starring Marlon Brando, Al Pacino, and James Caan. The film tells the story of the Corleone family, a powerful Italian-American mafia clan.", "callsToAction" : ["Watch Now", "Learn More"]}]}}`},
        {"role": "user", "content": componentInput}
      ])
      break;
    case "HeroSectionComponent":
      setMessages([
        {"role": "system", "content": `You are a helpful assistant who generates only JSON object completions and nothing more. The user will provide a prompt. Generate only one JSON completion per prompt. The JSON format must be adhered to strictly, but the content should be creative. Do not reply with 'sure..', 'here's..' or anything of the sort. JUST the completion.`},
        {"role": "user", "content": "Create a hero section for a food delivery website, orange in colour"},
        {"role": "system", "content": `{"theme": "food delivery", "colorScheme": "orange", "component": {"type": "HeroSectionComponent", "image": true, "content": [{"title": "Order delicious food today", "body":  "Choose from a wide range of cuisines and tasty dishes. Our team of chefs will ensure that you get the best quality food delivered right to your doorstep.", "topTag": "Tasty Food Delivered", "nav": ["Order Now", "Menu", "Offers", "About Us"], "callsToAction": ["Get Started", "See Trending Dishes"]}]}}`},
        {"role": "user", "content": componentInput}
      ])
      break;
    case "ModalComponent":
      setMessages([
        {"role": "system", "content": `You are a helpful assistant who generates only JSON object completions and nothing more. The user will provide a prompt. Generate only one JSON completion per prompt. The JSON format must be adhered to strictly, but the content should be creative. Do not reply with 'sure..', 'here's..' or anything of the sort. JUST the completion.`},
        {"role": "user", "content": "Modal for deleting a file, red"},
        {"role": "system", "content": `{"theme": "delete", "colorScheme": "red", "component": {"type": "ModalComponent", "image": true, "content": [{"title": "Delete File", "body": "Are you sure you want to delete this file? This action cannot be undone.", "options": ["Delete", "Cancel"]}]}}`},
        {"role": "user", "content": componentInput}
      ])
      break;
    case "FeaturesSectionComponent":
      setMessages([
        {"role": "system", "content": `You are a helpful assistant who generates only JSON object completions and nothing more. The user will provide a prompt. Generate only one JSON completion per prompt. The JSON format must be adhered to strictly, but the content should be creative. Do not reply with 'sure..', 'here's..' or anything of the sort. JUST the completion.`},
        {"role": "user", "content": "Features Section for sustainable fashion brand, amber"},
        {"role": "system", "content": `{"theme": "Sustainable Fashion", "colorScheme": "amber", "component": {"type": "FeaturesSectionComponent", "image": true, "content":[{"header": "Look good, feel good, do good", "subHeader": "Our sustainable fashion brand offers stylish and affordable clothing that is good for both you and the planet. Join us in making a positive impact today!", "featureBlocks": [{"title" : "Eco-Friendly Materials", "titleDesc": "We use only eco-friendly materials in our clothing to reduce our environmental impact and promote sustainability. Our fabrics are made from organic cotton, recycled polyester, and other sustainable materials.", "subPoints": [{"id": 0, "point": "Organic Cotton", "pointDesc": "Our organic cotton is grown without the use of harmful pesticides and fertilizers, making it better for the environment and for the farmers who grow it."},{"id": 1,"point": "Recycled Polyester", "pointDesc": "We use recycled polyester made from post-consumer plastic bottles to reduce waste and promote recycling."},{"id": 2,"point": "Sustainable Materials", "pointDesc": "Our clothing is made from other sustainable materials such as Tencel and linen, which require less water and energy to produce."}] },{"title" : "Ethical Production", "titleDesc": "We are committed to ethical production practices and ensuring that our workers are treated fairly and paid a living wage. Our factories are located in countries with strong labor laws, and we work closely with our suppliers to ensure that they meet our ethical standards.", "subPoints": [{"id": 0, "point": "Fair Trade", "pointDesc": "We source our materials from fair trade suppliers who support workers' rights and provide fair wages and working conditions."},{"id": 1, "point": "Sustainable Production", "pointDesc": "Our factories use sustainable production methods to minimize waste and reduce their environmental impact."}] }]}]}}`},
        {"role": "user", "content": componentInput}
      ])
      break;
    case "DashboardComponent":
      setMessages([
        {"role": "system", "content": `You are a helpful assistant who generates only JSON object completions and nothing more. The user will provide a prompt. Generate only one JSON completion per prompt. The JSON format must be adhered to strictly, but the content should be creative. Do not reply with 'sure..', 'here's..' or anything of the sort. JUST the completion.`},
        {"role": "user", "content": "Dashboard for a finance company, blue"},
        {"role": "system", "content": `{"theme": "finance", "colorScheme": "blue", "component": {"type": "DashboardComponent", "image": false, "content":[{"header": "Welcome, Jane !", "statsTitle" : "Your Financial Overview", "stats": [{"title": "Total Income", "data" : "$50,000"}, {"title": "Total Expenses", "data" : "$30,000"}, {"title": "Net Worth", "data": "$20,000"}], "tableTitle": "Recent Transactions", "actions": [{"id": 1, "name": "Payment Received", "status": "completed", "date": "Feb 28, 2023"}, {"id": 2, "name": "Bill Payment", "status": "completed", "date": "Feb 25, 2023"}, {"id": 3, "name": "Investment", "status": "pending", "date": "Feb 22, 2023"}]}]}}`},
        {"role": "user", "content": componentInput}
      ])
      break;
    case "TestimonialComponent":
      setMessages([
        {"role": "system", "content": `You are a helpful assistant who generates only JSON object completions and nothing more. The user will provide a prompt. Generate only one JSON completion per prompt. The JSON format must be adhered to strictly, but the content should be creative. Do not reply with 'sure..', 'here's..' or anything of the sort. JUST the completion.`},
        {"role": "user", "content": "yellow testimonial for interior design company"},
        {"role": "system", "content": `{"theme": "Interior Design", "colorScheme": "yellow", "component": {"type": "TestimonialComponent", "image": true, "content": [{"title": "Transformed my home into a masterpiece", "body": "I hired this company to redesign my home and I couldn't be happier with the results. The team was professional and easy to work with, and they really listened to my vision for my home. The end result was a beautifully designed space that exceeded my expectations.", "womanSource": "Samantha Lee", "womanSourcePosition":"Homeowner", "company": "Samantha's Home"}, {"title": "Highly recommend this interior design company", "body": "I've worked with several interior design companies in the past, but this one is by far the best. Their team is creative, knowledgeable, and truly passionate about what they do. They transformed my space into a stunning work of art and I couldn't be happier with the results.", "manSource": "Ryan Davis", "manSourcePosition":"Architect", "company": "Davis Architecture"}]}}`},
        {"role": "user", "content": componentInput}
      ])
      break;
    default:
      setMessages({
        ...messages,
      })
  }
}

/* Create a grid of vertical cards for food items, orange */
function GetGPTCompletion({componentInput, selectedComponent, messages, setMessages}) {
    const apiEndpoint = "https://api.openai.com/v1/chat/completions";
    const apiKey = import.meta.env.VITE_OPENAI_KEY;
    const authHeader = `Bearer ${apiKey}`;
    const contentTypeHeader = "application/json";
    
    async function fetchGPTResponse(){
    //choosePrompt({selectedComponent, selectedPrompt, setSelectedPrompt});
   
    //await new Promise((resolve) => choosePrompt({ selectedComponent, selectedPrompt, setSelectedPrompt, resolve }));

      
      //   const messages = [
      //     {"role": "system", "content": `You are a helpful assistant who generates only JSON object completions and nothing more. The user will provide a prompt. Generate only one JSON completion per prompt. The JSON format must be adhered to strictly, but the content should be creative. Do not reply with 'sure..', 'here's..' or anything of the sort. JUST the completion.`},
      //     {"role": "user", "content": selectedPrompt.prompt},
      //     {"role": "system", "content": selectedPrompt.completion},
      //     {"role": "user", "content": componentInput}
      // ]
  
    
    // setMessages([
    //   ...messages,
    //   {"role": "system", "content": `You are a helpful assistant who generates only JSON object completions and nothing more. The user will provide a prompt. Generate only one JSON completion per prompt. The JSON format must be adhered to strictly, but the content should be creative. Do not reply with 'sure..', 'here's..' or anything of the sort. JUST the completion.`},
    //   {"role": "user", "content": selectedPrompt.prompt},
    //   {"role": "system", "content": selectedPrompt.completion},
    //   {"role": "user", "content": componentInput}
    // ])
   
    console.log(messages);
    
    // const apiPayload = {
    //   model: "gpt-3.5-turbo",
    //   max_tokens: 600,
    //   messages,
    // };
  
    // const response = await fetch(apiEndpoint, {
    //   method: "POST",
    //   headers: {
    //     Authorization: authHeader,
    //     "Content-Type": contentTypeHeader,
    //   },
    //   body: JSON.stringify(apiPayload),
    // });
  
    // return await response.json();
  }
  useEffect(() => {
    async function fetchGPTResponse() {
      // Call choosePrompt function here and update the state accordingly
      // Example: const prompt = await choosePrompt(selectedComponent, componentInput);
      // Then, update the messages state with the prompt
      // Example: setMessages([...messages, {role: 'user', content: prompt}]);
      choosePrompt({selectedComponent, messages, setMessages, componentInput});
      console.log(messages);
    }
    fetchGPTResponse();
  }, [selectedComponent, componentInput, messages]);

 // fetchGPTResponse();
}

export default GetGPTCompletion;